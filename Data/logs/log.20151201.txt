ManagedPoolThread #7 00:00:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 00:00:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 00:00:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 00:00:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 00:00:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 00:00:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 00:00:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 00:00:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 00:00:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 00:00:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 00:00:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 00:00:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16408 00:00:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 00:00:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9044 00:00:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 00:00:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:00:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


9636 00:00:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:00:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


6932 00:00:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


13012 00:00:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #6 00:00:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 00:00:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 00:00:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:00:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:00:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #11 00:00:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 00:00:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16408 00:00:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:00:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:00:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:00:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:00:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:00:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:00:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:00:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:00:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:00:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:00:45 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:00:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:00:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:00:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:00:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:00:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:00:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:01:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:01:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:01:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:01:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:01:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:01:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:01:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 00:01:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:01:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:01:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #17 00:01:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14588 00:01:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:01:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 00:01:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:01:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 00:01:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 00:01:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 00:01:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 00:01:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:01:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 00:01:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 00:01:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 00:01:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 00:01:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 00:01:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16552 00:01:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16408 00:01:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 00:01:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9044 00:01:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 00:01:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:01:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 00:01:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14588 00:01:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 00:01:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:01:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 00:01:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:01:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 00:01:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 00:01:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:01:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:01:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:01:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 00:01:43 INFO  Health.PrivateBytes: 0
Heartbeat 00:01:43 INFO  Health.CacheInstances: 119
Heartbeat 00:01:43 INFO  Health.CacheTotalCount: 24,756
Heartbeat 00:01:43 INFO  Health.CacheTotalSize: 91,815,526
17308 00:01:45 INFO  [Path Analyzer](.) Running trail cleanup agent
17308 00:01:45 INFO  [Path Analyzer](.) Running trail cleanup on database
8276 00:01:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:01:45 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:01:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:01:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:01:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:01:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:01:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:01:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:02:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:02:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:02:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:02:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:02:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:02:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:02:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:02:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:02:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:02:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:02:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:02:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:02:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:02:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:02:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 00:02:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14588 00:02:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 00:02:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:02:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 00:02:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:02:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 00:02:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 00:02:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 00:02:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 00:02:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 00:02:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 00:02:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 00:02:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 00:02:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:02:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #3 00:02:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16408 00:02:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 00:02:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9044 00:02:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 00:02:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 00:02:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9636 00:02:45 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:02:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 00:02:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:02:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 00:02:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:02:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:02:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:02:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #11 00:02:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 00:02:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:02:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:02:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:02:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:03:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:03:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:03:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:03:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:03:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:03:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:03:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:03:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:03:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:03:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:03:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:03:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:03:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:03:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:03:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:03:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:03:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:03:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:03:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:03:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:03:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:03:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 00:03:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9636 00:03:45 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:03:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 00:03:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:03:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 00:03:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:03:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 00:03:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:03:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 00:03:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 00:03:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 00:03:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 00:03:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 00:03:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 00:03:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 00:03:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:03:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 00:03:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16408 00:03:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 00:03:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9044 00:03:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 00:03:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 00:03:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 00:04:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14588 00:04:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 00:04:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:04:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 00:04:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:04:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:04:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 00:04:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:04:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:04:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:04:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:04:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:04:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:04:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:04:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:04:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:04:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:04:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:04:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:04:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:04:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:04:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:04:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:04:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:04:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:04:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:04:45 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:04:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:04:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:04:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:04:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:04:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:04:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:04:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 00:04:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 00:05:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14588 00:05:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 00:05:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:05:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 00:05:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:05:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:05:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 00:05:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 00:05:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 00:05:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 00:05:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 00:05:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 00:05:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 00:05:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 00:05:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:05:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 00:05:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16408 00:05:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 00:05:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9044 00:05:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 00:05:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 00:05:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 00:05:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9636 00:05:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:05:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 00:05:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:05:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 00:05:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:05:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:05:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:05:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:05:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:05:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:05:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:05:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:05:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:05:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:05:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:05:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:05:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:05:45 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:05:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:05:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:05:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:05:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:05:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:05:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:05:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:06:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:06:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:06:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:06:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:06:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:06:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 00:06:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 00:06:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 00:06:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9636 00:06:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:06:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 00:06:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:06:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 00:06:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:06:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 00:06:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 00:06:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 00:06:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 00:06:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 00:06:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 00:06:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 00:06:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 00:06:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:06:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 00:06:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16408 00:06:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:06:27 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #6 00:06:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 00:06:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 00:06:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14588 00:06:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:06:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:06:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



6932 00:06:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 00:06:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:06:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 00:06:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:06:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:06:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:06:42 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17308 00:06:45 INFO  [Path Analyzer](.) Running trail cleanup agent
17308 00:06:45 INFO  [Path Analyzer](.) Running trail cleanup on database
7820 00:06:45 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
9636 00:06:45 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:06:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:06:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:06:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:06:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:06:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:06:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:06:57 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:07:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:07:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:07:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:07:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:07:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:07:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:07:12 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:07:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:07:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:07:16 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:07:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:07:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:07:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 00:07:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 00:07:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 00:07:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 00:07:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14588 00:07:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:07:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 00:07:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:07:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 00:07:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:07:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 00:07:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 00:07:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 00:07:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 00:07:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 00:07:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 00:07:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 00:07:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 00:07:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:07:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16552 00:07:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16408 00:07:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


9044 00:07:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #6 00:07:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 00:07:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9636 00:07:45 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:07:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 00:07:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:07:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 00:07:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:07:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 00:07:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:07:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:07:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



8276 00:07:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:07:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:07:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:08:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:08:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:08:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:08:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:08:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:08:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:08:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:08:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:08:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:08:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:08:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:08:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:08:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:08:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:08:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:08:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:08:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:08:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:08:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:08:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16552 00:08:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9044 00:08:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 00:08:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 00:08:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 00:08:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9636 00:08:45 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:08:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 00:08:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:08:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 00:08:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:08:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 00:08:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 00:08:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 00:08:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 00:08:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 00:08:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 00:08:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 00:08:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 00:08:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:08:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 00:08:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16408 00:08:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


9044 00:08:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 00:08:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 00:08:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:09:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:09:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



14588 00:09:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 00:09:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:09:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 00:09:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:09:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 00:09:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:09:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:09:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:09:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:09:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:09:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:09:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:09:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:09:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:09:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:09:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:09:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:09:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:09:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:09:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:09:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:09:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:09:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:09:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:09:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9636 00:09:45 INFO  [Experience Analytics]: Reduce agent found zero sites to process
14588 00:09:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:09:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:09:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

8276 00:09:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 00:09:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9044 00:09:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 00:09:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 00:09:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9056 00:10:00 ERROR An error occurred while reading an automation state document related to contact {B18D18D3-9F89-480B-9D08-26295B1EF55E} was found in the AutomationStates collection. Mongo collection returned null.
15928 00:10:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 00:10:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14588 00:10:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 00:10:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:10:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 00:10:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:10:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 00:10:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16552 00:10:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 00:10:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 00:10:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 00:10:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 00:10:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 00:10:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 00:10:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8276 00:10:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 00:10:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
16408 00:10:13 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


9044 00:10:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 00:10:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 00:10:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9636 00:10:15 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #1 00:10:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14588 00:10:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 00:10:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6932 00:10:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 00:10:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
13012 00:10:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:10:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
15928 00:10:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



8276 00:10:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

16408 00:10:28 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9044 00:10:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14588 00:10:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6932 00:10:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

13012 00:10:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

15928 00:10:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

10428 00:10:39 INFO  **************************************************
10428 00:10:39 WARN  Sitecore shutting down
10428 00:10:39 WARN  Shutdown message: HostingEnvironment initiated shutdown
